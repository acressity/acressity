{# Expects user object passed in as explorer #}
{# Referring template must convert accordingly (with-as statement) #}

{% load explorers_extras %}
{% load notifications_tags %}
{% load comments %}

<div class="explorer_item">
    <a href="{{ explorer.get_absolute_url }}">
        <div class="featured_photo">
            <img src="{{ explorer.get_thumbnail_url }}" />
        </div>

        <h3 class="align_center">
            {{ explorer.get_full_trailname }}
        </h3>
    </a>

    <div class="option_list">
        <a href="{% url 'profile' explorer.id %}">
            <img src="{{ STATIC_URL }}img/icons/user.png" title="View {% ifequal explorer user %}your{% else %}{{ explorer.get_full_name|possessive }}{% endifequal %} profile" class="option_icon" />
        </a>
        <a href="{% url 'board' explorer.id %}">
            <span class="position_relative">
                <img src="{{ STATIC_URL }}img/icons/bulletin-board-icon_grayscale.png" title="View {% ifequal explorer user %}your{% else %}{{ explorer.get_full_name|possessive }}{% endifequal %} bulletin board" class="option_icon" />

                {% if user == explorer %}
                    {% notifications_unread as unread_count %}
                    {% if unread_count %}
                        <span class="photo-top-right badge notification-badge">{{ unread_count }}</span>
                    {% endif %}
                {% endif %}
            </span>
        </a>
        {% if explorer.gallery.featured_photo %}
            <a href="{% url 'pl-gallery' explorer.gallery.id %}">
                <img src="{{ STATIC_URL }}img/icons/images.png" title="View {% ifequal explorer user %}your{% else %}{{ explorer.get_full_name|possessive }}{% endifequal %} photos" class="option_icon" />
            </a>
        {% endif %}
        {% ifequal user explorer %} 
            <a href="{% url 'create_experience' %}">
                <img src="{{ STATIC_URL }}img/icons/add.png" class="option_icon" title="Create new experience" />
            </a>
        {% endifequal %}
    </div>

    {% if explorer.brief %}
        <div class="explorer_item">
            <div onclick="toggle_div(this.nextElementSibling);">
                {% ifequal explorer user %}Your{% else %}{{ explorer.get_full_name|possessive }}{% endifequal %} brief
                 <img src="{{ STATIC_URL }}img/icons/expand-icon.png"
                class="valign_middle" />
            </div>
            <div class="toggle_div">
                <div class="explorer_item">
					{{ explorer.brief|linebreaks }}
				</div>
            </div>
        </div>
    {% endif %}
    {% if explorer.featured_experience %}
        {% url 'experience' explorer.featured_experience.id as featured_experience_path %}
        {% if featured_experience_path != request.path %}
            {% if explorer.featured_experience.is_public or user == explorer %}
                <div class="experience_item">
                    <div onclick="toggle_div(this.nextElementSibling);" title="Click to toggle {% ifequal user explorer %}your{% else %}{{ explorer.get_full_name|possessive }}{% endifequal %} featured experience" style="font-weight: bold;">
                        Featured experience <img src="{{ STATIC_URL }}img/icons/expand-icon.png" class="valign_middle" />
                    </div>
                    <div class="toggle_div">
                        {% with experience=explorer.featured_experience stacked=True %}
                            {% include "experiences/snippets/dash.html" %}
                        {% endwith %}
                    </div>
                </div>
            {% endif %}
        {% endif %}
    {% endif %}
</div>
