{% extends "experiences/base.html" %}

{% block content %}
	<script type="text/javascript">
	$(document).ready(function(){
		e = document.getElementById("id_is_public");
		d = document.getElementById("password_div");
		if (e.checked){
			$(d).css("display", "none");  {# If this initial setting is correct, the toggling of the password div should be on par with future checking and unchecking. Is my logic flawed???? #}
		}
	})
	</script>
	<h2>Editing experience <em>{{ experience }}</em></h2>
	<form action="" method="POST" class="full_width">
		{% csrf_token %}
		<div class="formatted_input">
			<label for="id_experience">
				<h3>Title</h3>
			</label>
			{{ form.experience.errors }}
			{{ form.experience }}
		</div>
		<p>{{ form.featured_photo }}</p>
		
		<div class="formatted_input">
			<label for="id_status">
				<h3>Status</h3>
			</label>
			{{ form.status.errors }}
			{{ form.status }}
			<div class="about_this">
				<p onclick="toggle_div('status_help_text');">
					About this <img src="{{ STATIC_URL }}img/icons/expand-icon.png" id="status_help_text_toggle_icon" />
				</p>
				<div class="toggle_div help-text" id="status_help_text">
					{{ form.status.help_text }}
				</div>
			</div>
		</div>
		<div class="formatted_input">
			<label for="id_brief">
				<span title="About the experience"><h3>Brief</h3></span>
			</label>
			{{ form.brief.errors }}
			{{ form.brief }}
			<div class="about_this">
				<p onclick="toggle_div('brief_help_text');">
					About this <img src="{{ STATIC_URL }}img/icons/expand-icon.png" id="brief_help_text_toggle_icon" />
				</p>
				<div class="toggle_div help-text" id="brief_help_text">
					{{ form.brief.help_text }}
				</div>
			</div>
		</div>
		<div onclick="toggle_div('additional_options')"><h3>More Options <img src="{{ STATIC_URL }}img/icons/expand-icon.png" id="additional_options_toggle_icon" /></h3></div>
        <div id="additional_options" class="toggle_div">
        	<div class="formatted_input">	
				<h3>Date created</h3>
				{{ form.date_created.errors }}
				{{ form.date_created }}
			</div>
			{% ifnotequal experience user.featured_experience %}
				<div class="formatted_input">
					<strong>Make this your featured experience?</strong> {{ form.make_feature }}
					{{ form.make_feature.errors }}
					<div class="about_this">
						<p onclick="toggle_div('make_feature_help_text');">
							About this <img src="{{ STATIC_URL }}img/icons/expand-icon.png" id="make_feature_help_text_toggle_icon" />
						</p>
						<div class="toggle_div help-text" id="make_feature_help_text">
							{{ form.make_feature.help_text }}
						</div>
					</div>
				</div>
			{% endifnotequal %}
			{% ifequal user experience.author %}
				{# Will need to be more secure... Easy to change POST information, I think #}
				<div class="formatted_input">
					<strong>Public?</strong> {{ form.is_public }}
					<script type="text/javascript">
						e = document.getElementById("id_is_public");
						d = document.getElementById("password_div");
						e.onclick = function(){
							toggle_div("password_div");
						};
					</script>
					{{ form.is_public.errors }}
					<div class="about_this">
						<div onclick="toggle_div(this.nextElementSibling);">
							About this <img src="{{ STATIC_URL }}img/icons/expand-icon.png" id="is_public_help_text_toggle_icon" />
						</div>
						<div class="toggle_div help-text" id="is_public_help_text">
							{{ form.is_public.help_text }}
						</div>
					</div>
				</div>
				<div id="password_div" class="formatted_input">
					<strong>Password</strong>
					{{ form.password.errors }}
					{{ form.password }}
					<div onclick="toggle_div(this.nextElementSibling);">
						<strong>About this <img src="{{ STATIC_URL }}img/icons/expand-icon.png" id="password_help_text_toggle_icon" /></strong>
					</div>
					<div class="toggle_div help-text" id="password_help_text">
						{{ form.password.help_text }}
					</div>
				</div>
				<div id="search_term_div" class="formatted_input">
					<strong>Search term</strong>
					{{ form.search_term.errors }}
					{{ form.search_term }}
					<div class="about_this">
						<div onclick="toggle_div(this.nextElementSibling);">
							About this <img src="{{ STATIC_URL }}img/icons/expand-icon.png" id="about_search_term_toggle_icon" />
						</div>
						<div class="toggle_div help-text" id="about_search_term">
							{{ form.search_term.help_text }}
						</div>
					</div>
				</div>
			{% endifequal %}
		</div>
		<input type="hidden" name="experience_id" value="{{ experience.id }}" />
		<input type="hidden" name="explorer_id" value="{{ experience.explorer.id }}"/>
		<input type="submit" value="Update" />
	</form>
	{% comment %}
		{# Phasing this out in favor of having a less cluttered page #}
		<div class="option_list">
			<a href="{% url 'narratives.views.create' experience.id %}"><img src="{{ STATIC_URL }}img/icons/new-narrative-icon.png" title="Create new narrative for {{ experience }}" class="option_icon" /></a>
			<a href="/experiences/{{ experience.id }}/categorize/"><img src="{{ STATIC_URL }}img/icons/categorize-icon.png" title="Categorize the narratives in this experience" class="option_icon" /></a>
			<a href="{% url 'experiences.views.index' experience.id %}"><img src="{{ STATIC_URL }}img/icons/back-icon.png" title="Go back to experience page" class="option_icon" /></a>
			<a href="{% url 'experiences.views.upload_photo' experience.id %}"><img src="{{ STATIC_URL }}img/icons/image-upload-icon.png" title="Upload image" class="option_icon" /></a>
			{% if experience.gallery %}
				<a href="/photologue/gallery/{{ experience.gallery.id }}/"><img src="{{ STATIC_URL }}img/icons/gallery-icon.png" title="View gallery" class="option_icon" /></a>
			{% endif %}
		</div>
	{% endcomment %}
{% endblock content %}
