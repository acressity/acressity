{# Expects `url` and `form` to be passed in by including file #}

<form action="{{ url }}" method="POST" class="full_width">
    {% csrf_token %}
    <div class="formatted_input">
        <h3>Title</h3>
        {{ form.experience.errors }}
        {{ form.experience }}
    </div>
    <div class="formatted_input">
        <label for="id_is_public">    
            <h3>Public? {{ form.is_public }}</h3>
            <script type="text/javascript">
                e = document.getElementById("id_is_public");
                d = document.getElementById("password_div");
                e.onclick = function(){
                    toggle_div("password_div");
                };
            </script>
        </label>
        <div class="about_this">
            <div onclick="toggle_div('about_public_experiences');" class="smaller">
                <strong>About this <img src="{{ STATIC_URL }}img/icons/expand-icon.png" id="about_public_experiences_toggle_icon" /></strong>
            </div>
            <div id="about_public_experiences" class="toggle_div help-text">
                {{ form.is_public.help_text}}
            </div>
        </div>
    </div>
    <div class="formatted_input">
        <h3>Status <em>(optional)</em></h3>
        {{ form.status.errors }}
        {{ form.status }}
        <div class="about_this">
            <p onclick="toggle_div('status_help_text');">
                About this <img src="{{ STATIC_URL }}img/icons/expand-icon.png" id="status_help_text_toggle_icon" />
            </p>
            <div class="toggle_div help-text" id="status_help_text">
                {{ form.status.help_text }}
            </div>
        </div>
    </div>
    <div class="formatted_input">
        <h3>Brief <em>(optional)</em></h3>
        {{ form.brief.errors }}
        {{ form.brief }}
        <div class="about_this">
            <p onclick="toggle_div('brief_help_text');">
                About this <img src="{{ STATIC_URL }}img/icons/expand-icon.png" id="brief_help_text_toggle_icon" />
            </p>
            <div class="toggle_div help-text" id="brief_help_text">
                {{ form.brief.help_text }}
            </div>
        </div>
    </div>
    <div onclick="toggle_div('additional_options')"><h3>More Options <img src="{{ STATIC_URL }}img/icons/expand-icon.png" id="additional_options_toggle_icon" /></h3></div>
    <div id="additional_options" class="toggle_div">
        <div class="formatted_input">
            <h3>Is this experience fulfilled? {{ form.is_fulfilled }}</h3>
            <div class="about_this">
                <p onclick="toggle_div('about_is_fulfilled');" class="smaller">
                    About this <img src="{{ STATIC_URL }}img/icons/expand-icon.png" id="about_is_fulfilled_toggle_icon" class="valign_middle" />
                </p>
                <div id="about_is_fulfilled" class="toggle_div help-text">
                    {{ form.is_fulfilled.help_text }}
                </div>
            </div>
        </div>
        <div class="formatted_input">
            <h3>Date created (leave blank for today)</h3>
            {{ form.date_created.errors }}
            {{ form.date_created }}
        </div>
        <div class="formatted_input">
            {% if user.featured_experience %}
                <p><strong>Your featured experience is currently</strong></p>
                <div class="experience_item">{{ user.featured_experience }}</div>
            {% endif %}
            <label for="id_make_feature">    
                <h3>Make this experience your featured experience? {{ form.make_feature }}</h3>
            </label>
            <div class="about_this">
                <div onclick="toggle_div('about_featured_experience');" class="smaller">
                    <strong>About this <img src="{{ STATIC_URL }}img/icons/expand-icon.png" id="about_featured_experience_toggle_icon" /></strong>
                </div>
                <div id="about_featured_experience" class="toggle_div help-text">
                    {{ form.make_feature.help_text }}
                </div>
            </div>
        </div>
        {# No need to check whether user is author #}
        {# By default, the password field is hidden since default state for is_public is false #}
        <div id="password_div" class="formatted_input hidden">
            <strong>Password</strong>
            {{ form.password.errors }}
            {{ form.password }}
            <div onclick="toggle_div(this.nextElementSibling);">
                <strong>About this <img src="{{ STATIC_URL }}img/icons/expand-icon.png" id="password_help_text_toggle_icon" /></strong>
            </div>
            <div class="toggle_div help-text" id="password_help_text">
                {{ form.password.help_text }}
            </div>
        </div>
        <div class="formatted_input">
            <label for="id_search_term">
                <h3>Search term</h3>
                {{ form.search_term.errors }}
                {{ form.search_term }}
            </label>
            <div class="about_this">
                <div onclick="toggle_div('about_search_term');" class="smaller">
                    <strong>About this <img src="{{ STATIC_URL }}img/icons/expand-icon.png" id="about_search_term_toggle_icon" /></strong>
                </div>
                <div id="about_search_term" class="toggle_div help-text">
                    {{ form.search_term.help_text|safe }}
                </div>
            </div>
        </div>
        <div class="formatted_input">
            {% if user.paypal_email_address %}
                <label for="id_accepts_paypal">
                    <h3>Accept PayPal donations {{ form.accepts_paypal }}</h3>
                </label>
                <div class="about_this">
                    <div onclick="toggle_div('about_accepts_paypal');" class="smaller">
                        <strong>About this <img src="{{ STATIC_URL }}img/icons/expand-icon.png" id="about_accepts_paypal_toggle_icon" /></strong>
                    </div>
                    <div id="about_accepts_paypal" class="toggle_div help-text">
                        {{ form.accepts_paypal.help_text|safe }}
                    </div>
                </div>
            {% else %}
                <p>
                    To enable receiving PayPal donations, fill out the PayPal email field in your <a href="{% url 'profile' user.id %}">profile.</a>
                </p>
            {% endif %}
        </div>
    </div>
    <div class="formatted_input align_center">
        <input type="submit" value="Save" />
    </div>
</form>
